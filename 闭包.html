<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>闭包</title>
</head>

<body>
    <script type="text/javascript">
    //闭包就是能够读取其他函数内部变量的函数,如下f2。
    function createAFunction() {
        var i = "k";

        function f2() {
            alert(i);
        }
        console.log(f2);
        return f2;

    }
    var result1 = createAFunction();
    result1();

    //两大用处:一个是前面提到的可以读取函数内部的变量，另一个就是让这些变量的值始终保持在内存中，不被垃圾回收机制回收
    function f1() {　　　　
        var n = 999;　
        //aAdd全局变量　　　
        nAdd = function() {
            n += 1
        }　　　　
        function f2() {　　　　　　
            alert(n);　　　　
        }　　　　
        return f2;　　
    }　　
    var result = f1();　　
    result(); // 999
    nAdd();　　
    result(); // 1000

    function foo(x){
            var tmp = 3;
            return function(y){
                alert(x+y+(++tmp));
            }
        }
        var bar = foo(2);
        bar(10); //16

    /*
	使用闭包的注意点:
		1由于闭包会使得函数中的变量都被保存在内存中，内存消耗很大，所以不能滥用闭包，否则会造成网页的性能问题，在IE中可能导致内存泄露。解决方法是，在退出函数之前，将不使用的局部变量全部删除。
		2闭包会在父函数外部，改变父函数内部变量的值。所以，如果你把父函数当作对象（object）使用，把闭包当作它的公用方法（Public Method），把内部变量当作它的私有属性（private value），这时一定要小心，不要随便改变父函数内部变量的值。
    */
    </script>
</body>
<!-- 
	内存泄露
	垃圾回收机制
	作用域，作用域链
 -->
</html>
